package cert

import "testing"

const (
	certificate = `-----BEGIN CERTIFICATE-----
MIICxDCCAaygAwIBAgIRAIEKG9Ei3RuiB4dylA39lCIwDQYJKoZIhvcNAQELBQAw
ADAeFw0yMDEwMjExNTU1MTRaFw0yMTAxMTkxNTU1MTRaMAAwggEiMA0GCSqGSIb3
DQEBAQUAA4IBDwAwggEKAoIBAQDVRDzTO+irRoEj4bArwhmMs/BAjiQemj5F8V1O
I/8tIicUr8xJak+DyJVZreyJuFDNqBOb1nsx3HKpUQA7K8wC844wYbizVVszOqcA
d7Dng+Yh59ly6EY2l2ZCb/9BWGVUsHO0RK3opauxnWP6SFgF+Vowg5GEPlFEKWrd
/Mcdem/7GIdWmEaS/5bPAuveCvSCMLwNpXXUONMjxKCgSkgt9l/aGfMVU7JFjsE2
yTmeqLpTcsZNIn+yrdFP5KWQ/scfWb3tZ6mreejJzTV+UN6hKkqTehCkFs4ngGc2
hs7BVI9sf5BXK08+aeRBfIoXqGKfJ2koYBOaHyG5bzQzjoElAgMBAAGjOTA3MA4G
A1UdDwEB/wQEAwIFoDAMBgNVHRMBAf8EAjAAMBcGA1UdEQEB/wQNMAuCCW15aHR0
cGJpbjANBgkqhkiG9w0BAQsFAAOCAQEA1MKN22RCuTICZFs4nzZJnxBkma8z0gJW
pENNZxO0qDP0qr9HKTJL53fGVBunsw8BsQNVKHhOFBfnn+7mMLK5Mc4iFH0tSGOy
gp2Ni1e/P8HgcujCextfPpkg+WyfdtVQ/4ntiISJs+Dnjnk0eBMOsITqNy+i+SR/
S2CVZvprzBFJurPuo0IUlGk9RAk7mvudVrIGcUCXdZ5iQkaiEYjfcaBPIrUE2m9W
zEXzyBQLMTjQZ41F73H0p1yOne4gWbT8QtnQEnCZ0WQ5hSUx/qYMGNbVCByrwXhl
r214QwHmdTwnVuolM2jALtf5jvdHllTdCMgdVsWB4XUO9AHEO4il+w==
-----END CERTIFICATE-----`
	key = `-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA1UQ80zvoq0aBI+GwK8IZjLPwQI4kHpo+RfFdTiP/LSInFK/M
SWpPg8iVWa3sibhQzagTm9Z7MdxyqVEAOyvMAvOOMGG4s1VbMzqnAHew54PmIefZ
cuhGNpdmQm//QVhlVLBztESt6KWrsZ1j+khYBflaMIORhD5RRClq3fzHHXpv+xiH
VphGkv+WzwLr3gr0gjC8DaV11DjTI8SgoEpILfZf2hnzFVOyRY7BNsk5nqi6U3LG
TSJ/sq3RT+SlkP7HH1m97Wepq3noyc01flDeoSpKk3oQpBbOJ4BnNobOwVSPbH+Q
VytPPmnkQXyKF6hinydpKGATmh8huW80M46BJQIDAQABAoIBAA/sKVJoDaYD/I5O
QlXyBvBPWuem9SFnyLB2Jc44t8uJ2jscKPduPYOMTUJFzvw1S6sfGl+vMsF1QQZN
KuRAD9pEjuAj26NgAxAfF+rcBNQ0L9FmOwDuQJfA0/yv2fHqBJ6/EdRqsEVHYTtA
kf9UuWWwyUAIAqxJ7s1U/kqWndMgdynhSIhgHxB0o2bQBb+WkZoc8fZ/CeiF/1uh
5uNy6E77XCvBBBoUL36C9DWnPI0afoB2/S+de59FO1WWRh6RzQIq8uRH07G2vyLM
uyR/PyJAxnn+JQh/JDFR8eJWYVcXh1o2KhQzQPPRbW8NjVe3O+A3wTSZl/aWK3nd
hh+NAmECgYEA6iTmqpoQ0qnmhGTJtMpOCQygBHDssF3aAoOTC5qOP5s56gB+qszt
S3ZzlDDWXLwBQlBXojrZUa1vsn8jLzW8oHK3aqm2Qwmv9istcnDRWea8ZB4hqjRo
obb6dtcOhuXE4rlNTSnbsHBU2NN5z8gZQzw10FeiJZcy9G+vdMsTHj0CgYEA6Sxy
TGeHHahXfynz6iKh6bJvzeCUi4PfrzZ+kcKefE9dpi/5/QrOBE6V7q3ESaPeRKLq
thBeCvquhg00lLXGirYNyWPiX5fF0oTjx81IFDcB0m6dq4RWZcH6SYLFktv8lLLo
XzOFB9vtUiQICy7UQhplTksuLZ9nVYUhvjNsRQkCgYEAqx481gGyucMhjTB7mX0g
esyXRaeh02NDqQKvvJM/0oyHTtT9vaX25mezIGJwx2U/Jk/BO/b2TBMMxs7Tz/Td
3gT4tyNA6M1zo9z6YeDBn4pZtHGw+MtEjKtFcQTKwRu7QFdcf0BQJipyV+R16by7
eb/PNGxXPFG8E5hsClc/qaECgYEAkZFP4ecX8SnxRdAZGGh6kHz3U54K3nZ7pNTu
e2z2qECcBG4bMSAXsZSmAZW13wtQbaUPxo29SDlrzwBbfSNmSZ6SSNH0txz3QQ/5
a/j6MLSOjKLGCBfcIDbTXCUp1x9DNkniy9xMBrYEGK2p3+FiXcpAyHoi4BSN3FP6
1tUfmJECgYBkCxtXqKg/51ysJu8kyYcuKnMc09MCxkHFDsQBhzvHfG3sKZkKhuom
UCsfGiCN4S75OAfd+eJbMRxwNY926do9BB13gTO2WKlK0rwPNhoLFnc64RVKCIJK
KTttDDD8hE1KyQaXtZljfByKqPCIssk1/+Ra/iYs/96dSOQlYtYaIA==
-----END RSA PRIVATE KEY-----`
	sha256Fingerprint = `fc0195000f8d2ea602a40a00def74239c6026d821b62c59dc355a4a8ee6b902b`
)

func TestCalculateFingerprint(t *testing.T) {
	fingerPrint := CalculateFingerPrint([]byte(certificate))
	if fingerPrint != sha256Fingerprint {
		t.Fatalf("fingerprints dont match:\n%s\n%s", sha256Fingerprint, fingerPrint)
	}
}
