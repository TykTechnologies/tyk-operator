apiVersion: v1
kind: Namespace
metadata:
  labels:
    control-plane: controller-manager
  name: tyk-operator-system
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  annotations:
    cert-manager.io/inject-ca-from: tyk-operator-system/tyk-operator-serving-cert
    controller-gen.kubebuilder.io/version: v0.3.0
  creationTimestamp: null
  name: apidefinitions.tyk.tyk.io
spec:
  additionalPrinterColumns:
  - JSONPath: .spec.proxy.listen_path
    name: Proxy.ListenPath
    type: string
  - JSONPath: .spec.proxy.target_url
    name: Proxy.TargetURL
    type: string
  - JSONPath: .spec.active
    name: Enabled
    type: boolean
  conversion:
    strategy: Webhook
    webhookClientConfig:
      caBundle: Cg==
      service:
        name: tyk-operator-webhook-service
        namespace: tyk-operator-system
        path: /convert
  group: tyk.tyk.io
  names:
    kind: ApiDefinition
    listKind: ApiDefinitionList
    plural: apidefinitions
    shortNames:
    - tykapis
    singular: apidefinition
  preserveUnknownFields: false
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: ApiDefinition is the Schema for the apidefinitions API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: APIDefinition represents the configuration for a single proxied
            API and it's versions.
          properties:
            active:
              type: boolean
            api_id:
              description: Only set this field if you are referring To an existing
                API in def. The Operator will use this API ID to link the CRD with
                the API in Tyk Note the values in the CRD will become the new source
                of truth, overriding the existing API Definition
              type: string
            auth:
              properties:
                auth_header_name:
                  type: string
                cookie_name:
                  type: string
                param_name:
                  type: string
                signature:
                  properties:
                    algorithm:
                      type: string
                    allowed_clock_skew:
                      format: int64
                      type: integer
                    error_code:
                      type: integer
                    error_message:
                      type: string
                    header:
                      type: string
                    secret:
                      type: string
                  required:
                  - algorithm
                  - allowed_clock_skew
                  - error_code
                  - error_message
                  - header
                  - secret
                  type: object
                use_certificate:
                  type: boolean
                use_cookie:
                  type: boolean
                use_param:
                  type: boolean
                validate_signature:
                  type: boolean
              required:
              - auth_header_name
              type: object
            auth_configs:
              additionalProperties:
                properties:
                  auth_header_name:
                    type: string
                  cookie_name:
                    type: string
                  param_name:
                    type: string
                  signature:
                    properties:
                      algorithm:
                        type: string
                      allowed_clock_skew:
                        format: int64
                        type: integer
                      error_code:
                        type: integer
                      error_message:
                        type: string
                      header:
                        type: string
                      secret:
                        type: string
                    required:
                    - algorithm
                    - allowed_clock_skew
                    - error_code
                    - error_message
                    - header
                    - secret
                    type: object
                  use_certificate:
                    type: boolean
                  use_cookie:
                    type: boolean
                  use_param:
                    type: boolean
                  validate_signature:
                    type: boolean
                required:
                - auth_header_name
                type: object
              type: object
            cache_options:
              properties:
                cache_all_safe_requests:
                  description: CacheAllSafeRequests caches responses to (GET, HEAD,
                    OPTIONS) requests overrides per-path cache settings in versions,
                    applies across versions
                  type: boolean
                cache_by_headers:
                  description: CacheByHeaders allows header values to be used as part
                    of the cache key
                  items:
                    type: string
                  type: array
                cache_control_ttl_header:
                  description: CacheControlTTLHeader is the response header which
                    tells Tyk how long it is safe to cache the response for
                  type: string
                cache_response_codes:
                  description: CacheOnlyResponseCodes is an array of response codes
                    which are safe to cache. e.g. 404
                  items:
                    type: integer
                  type: array
                cache_timeout:
                  description: CacheTimeout is the TTL for a cached object in seconds
                  format: int64
                  type: integer
                enable_cache:
                  description: EnableCache turns global cache middleware on or off.
                    It is still possible to enable caching on a per-path basis by
                    explicitly setting the endpoint cache middleware. see `spec.version_data.versions.{VERSION}.extended_paths.cache[]`
                  type: boolean
                enable_upstream_cache_control:
                  description: EnableUpstreamCacheControl instructs Tyk Cache to respect
                    upstream cache control headers
                  type: boolean
              required:
              - cache_timeout
              type: object
            custom_middleware:
              properties:
                auth_check:
                  properties:
                    name:
                      type: string
                    path:
                      type: string
                    raw_body_only:
                      type: boolean
                    require_session:
                      type: boolean
                  required:
                  - name
                  - path
                  type: object
                driver:
                  type: string
                id_extractor:
                  properties:
                    extract_from:
                      type: string
                    extract_with:
                      type: string
                  required:
                  - extract_from
                  - extract_with
                  type: object
                post:
                  items:
                    properties:
                      name:
                        type: string
                      path:
                        type: string
                      raw_body_only:
                        type: boolean
                      require_session:
                        type: boolean
                    required:
                    - name
                    - path
                    type: object
                  type: array
                post_key_auth:
                  items:
                    properties:
                      name:
                        type: string
                      path:
                        type: string
                      raw_body_only:
                        type: boolean
                      require_session:
                        type: boolean
                    required:
                    - name
                    - path
                    type: object
                  type: array
                pre:
                  items:
                    properties:
                      name:
                        type: string
                      path:
                        type: string
                      raw_body_only:
                        type: boolean
                      require_session:
                        type: boolean
                    required:
                    - name
                    - path
                    type: object
                  type: array
                response:
                  items:
                    properties:
                      name:
                        type: string
                      path:
                        type: string
                      raw_body_only:
                        type: boolean
                      require_session:
                        type: boolean
                    required:
                    - name
                    - path
                    type: object
                  type: array
              required:
              - driver
              type: object
            definition:
              properties:
                key:
                  type: string
                location:
                  type: string
                strip_path:
                  type: boolean
              required:
              - key
              - location
              - strip_path
              type: object
            enable_context_vars:
              description: EnableContextVars extracts request context variables from
                the start of the middleware chain. Set this to true to make them available
                to your transforms. Context Variables are available in the url rewriter,
                modify headers and body transforms.
              type: boolean
            graphql:
              description: GraphQLConfig is the root config object for a GraphQL API.
              properties:
                enabled:
                  description: Enabled indicates if GraphQL proxy should be enabled.
                  type: boolean
                execution_mode:
                  description: ExecutionMode is the mode to define how an api behaves.
                  enum:
                  - proxyOnly
                  - executionEngine
                  type: string
                playground:
                  description: GraphQLPlayground is the Playground specific configuration.
                  properties:
                    enabled:
                      description: Enabled indicates if the playground should be enabled.
                      type: boolean
                    path:
                      description: Path sets the path on which the playground will
                        be hosted if enabled.
                      type: string
                  required:
                  - enabled
                  - path
                  type: object
                schema:
                  description: Schema is the GraphQL Schema exposed by the GraphQL
                    API/Upstream/Engine.
                  type: string
                type_field_configurations:
                  description: TypeFieldConfigurations is a rule set of data source
                    and mapping of a schema field.
                  items:
                    properties:
                      data_source:
                        properties:
                          kind:
                            description: Kind defines the unique identifier of the
                              DataSource Kind needs to match to the Planner "DataSourceName"
                              name
                            type: string
                        required:
                        - kind
                        type: object
                      field_name:
                        type: string
                      mapping:
                        properties:
                          disabled:
                            type: boolean
                          path:
                            type: string
                        required:
                        - disabled
                        - path
                        type: object
                      type_name:
                        type: string
                    required:
                    - data_source
                    - field_name
                    - mapping
                    - type_name
                    type: object
                  type: array
              required:
              - enabled
              - execution_mode
              - schema
              type: object
            id:
              description: For server use only, do not use
              type: string
            listen_port:
              type: integer
            name:
              type: string
            org_id:
              description: OrgID is overwritten - no point setting this
              type: string
            protocol:
              type: string
            proxy:
              description: Proxy
              properties:
                check_host_against_uptime_tests:
                  description: CheckHostAgainstUptimeTests will check the hostname
                    of the outbound request against the downtime list generated by
                    the uptime test host checker. If the host is found, then it is
                    skipped or removed from the load balancer. This is only valid
                    if uptime tests for the api are enabled.
                  type: boolean
                disable_strip_slash:
                  description: DisableStripSlash disables the stripping of the slash
                    suffix from a URL. when `true` a request to http://foo.bar/baz/
                    will be retained. when `false` a request to http://foo.bar/baz/
                    will be matched to http://foo.bar/baz
                  type: boolean
                enable_load_balancing:
                  description: EnableLoadBalancing enables Tyk's round-robin loadbalancer.
                    Tyk will ignore the TargetURL field, and rely on the hosts in
                    the Targets list
                  type: boolean
                listen_path:
                  description: ListenPath represents the path to listen on. e.g. `/api`
                    or `/` or `/httpbin`. Any requests coming into the host, on the
                    port that Tyk is configured to run on, that match this path will
                    have the rules defined in the API Definition applied. Versioning
                    assumes that different versions of an API will live on the same
                    URL structure. If you are using URL-based versioning (e.g. /v1/function,
                    /v2/function) then it is recommended to set up a separate non-versioned
                    definition for each version as they are essentially separate APIs.
                  type: string
                preserve_host_header:
                  description: If PreserveHostHeader is set to true then the host
                    header in the outbound request is retained to be the inbound hostname
                    of the proxy.
                  type: boolean
                service_discovery:
                  description: 'TODO: Untested. Is there a use-case for SD inside
                    a K8s environment?'
                  properties:
                    cache_timeout:
                      format: int64
                      type: integer
                    data_path:
                      type: string
                    endpoint_returns_list:
                      type: boolean
                    parent_data_path:
                      type: string
                    port_data_path:
                      type: string
                    query_endpoint:
                      type: string
                    target_path:
                      type: string
                    use_discovery_service:
                      type: boolean
                    use_nested_query:
                      type: boolean
                    use_target_list:
                      type: boolean
                  required:
                  - cache_timeout
                  - data_path
                  - endpoint_returns_list
                  - parent_data_path
                  - port_data_path
                  - query_endpoint
                  - target_path
                  - use_discovery_service
                  - use_nested_query
                  - use_target_list
                  type: object
                strip_listen_path:
                  description: StripListenPath removes the inbound listen path in
                    the outgoing request. e.g. http://acme.com/httpbin/get where `httpbin`
                    is the listen path. The `httpbin` listen path which is used to
                    identify the API loaded in Tyk is removed, and the outbound request
                    would be http://httpbin.org/get
                  type: boolean
                target_list:
                  description: Targets defines a list of upstream host targets. Tyk
                    will then round-robin load balance between these targets. EnableLoadBalancing
                    must be set to true in order to take advantage of this feature.
                  items:
                    type: string
                  type: array
                target_url:
                  description: TargetURL defines the target URL that the request should
                    be proxied to.
                  type: string
                transport:
                  description: Transport section exposes advanced transport level
                    configurations such as minimum TLS version.
                  properties:
                    proxy_url:
                      description: ProxyURL specifies custom forward proxy & port.
                        e.g. `http(s)://proxy.url:1234`
                      type: string
                    ssl_ciphers:
                      description: SSLCipherSuites is an array of acceptable cipher
                        suites. A list of allowed cipher suites can be found in the
                        Go Crypto TLS package constants documentation https://golang.org/pkg/crypto/tls/#pkg-constants
                      items:
                        type: string
                      type: array
                    ssl_force_common_name_check:
                      description: SSLForceCommonNameCheck forces hostname validation
                        against the certificate Common Name
                      type: boolean
                    ssl_insecure_skip_verify:
                      description: SSLInsecureSkipVerify controls whether it is possible
                        to use self-signed certificates when connecting to the upstream.
                        This is applied to `TykMakeHttpRequest` & `TykMakeBatchRequest`
                        in virtual endpoint middleware.
                      type: boolean
                    ssl_min_version:
                      description: 'SSLMinVersion defines the minimum TLS version
                        the gateway will use to establish a connection to the upstream.
                        1.0: 769; 1.1: 770; 1.2: 771; 1.3: 772.'
                      enum:
                      - 769
                      - 770
                      - 771
                      - 772
                      type: integer
                  type: object
              required:
              - target_url
              type: object
            response_processors:
              items:
                properties:
                  name:
                    type: string
                required:
                - name
                type: object
              type: array
            tags:
              description: Tags are named gateway nodes which tell gateway clusters
                whether to load an API or not. for example, to load the API in an
                ARA gateway, you might want to include an `edge` tag.
              items:
                type: string
              type: array
            use_keyless:
              description: use_keyless will switch off all key checking. Some analytics
                will still be recorded, but rate-limiting, quotas and security policies
                will not be possible (there is no session to attach requests to).
              type: boolean
            use_standard_auth:
              description: UseStandardAuth enables simple bearer token authentication
              type: boolean
            version_data:
              properties:
                default_version:
                  type: string
                not_versioned:
                  type: boolean
                versions:
                  additionalProperties:
                    properties:
                      expires:
                        type: string
                      extended_paths:
                        properties:
                          advance_cache_config:
                            items:
                              properties:
                                cache_key_regex:
                                  type: string
                                cache_response_codes:
                                  items:
                                    type: integer
                                  type: array
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - cache_key_regex
                              - cache_response_codes
                              - method
                              - path
                              type: object
                            type: array
                          black_list:
                            items:
                              properties:
                                ignore_case:
                                  type: boolean
                                method_actions:
                                  additionalProperties:
                                    properties:
                                      action:
                                        type: string
                                      code:
                                        type: integer
                                      data:
                                        type: string
                                      headers:
                                        additionalProperties:
                                          type: string
                                        type: object
                                    required:
                                    - action
                                    - code
                                    - data
                                    - headers
                                    type: object
                                  type: object
                                path:
                                  type: string
                              required:
                              - ignore_case
                              - method_actions
                              - path
                              type: object
                            type: array
                          cache:
                            description: List of paths which cache middleware should
                              be enabled on
                            items:
                              type: string
                            type: array
                          circuit_breakers:
                            items:
                              properties:
                                disable_half_open_state:
                                  type: boolean
                                method:
                                  type: string
                                path:
                                  type: string
                                return_to_service_after:
                                  description: ReturnToServiceAfter represents the
                                    time in seconds to return back to the service
                                  type: integer
                                samples:
                                  description: Samples defines the number of requests
                                    to base the ThresholdPercent on
                                  format: int64
                                  type: integer
                                threshold_percent:
                                  description: ThresholdPercent is the percentage
                                    of requests that fail before breaker is tripped
                                  type: string
                              required:
                              - method
                              - path
                              - return_to_service_after
                              - samples
                              - threshold_percent
                              type: object
                            type: array
                          do_not_track_endpoints:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - method
                              - path
                              type: object
                            type: array
                          hard_timeouts:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                                timeout:
                                  type: integer
                              required:
                              - method
                              - path
                              - timeout
                              type: object
                            type: array
                          ignored:
                            items:
                              properties:
                                ignore_case:
                                  type: boolean
                                method_actions:
                                  additionalProperties:
                                    properties:
                                      action:
                                        type: string
                                      code:
                                        type: integer
                                      data:
                                        type: string
                                      headers:
                                        additionalProperties:
                                          type: string
                                        type: object
                                    required:
                                    - action
                                    - code
                                    - data
                                    - headers
                                    type: object
                                  type: object
                                path:
                                  type: string
                              required:
                              - ignore_case
                              - method_actions
                              - path
                              type: object
                            type: array
                          internal:
                            description: ValidateJSON            []ValidatePathMeta    `json:"validate_json,omitempty"`
                              //  Breaking integration test?
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - method
                              - path
                              type: object
                            type: array
                          method_transforms:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                                to_method:
                                  type: string
                              required:
                              - method
                              - path
                              - to_method
                              type: object
                            type: array
                          size_limits:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                                size_limit:
                                  format: int64
                                  type: integer
                              required:
                              - method
                              - path
                              - size_limit
                              type: object
                            type: array
                          track_endpoints:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - method
                              - path
                              type: object
                            type: array
                          transform:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                                template_data:
                                  properties:
                                    enable_session:
                                      type: boolean
                                    input_type:
                                      type: string
                                    template_mode:
                                      type: string
                                    template_source:
                                      type: string
                                  required:
                                  - enable_session
                                  - input_type
                                  - template_mode
                                  - template_source
                                  type: object
                              required:
                              - method
                              - path
                              - template_data
                              type: object
                            type: array
                          transform_headers:
                            items:
                              properties:
                                act_on:
                                  type: boolean
                                add_headers:
                                  additionalProperties:
                                    type: string
                                  type: object
                                delete_headers:
                                  items:
                                    type: string
                                  type: array
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - act_on
                              - add_headers
                              - delete_headers
                              - method
                              - path
                              type: object
                            type: array
                          transform_jq:
                            items:
                              properties:
                                filter:
                                  type: string
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - filter
                              - method
                              - path
                              type: object
                            type: array
                          transform_jq_response:
                            items:
                              properties:
                                filter:
                                  type: string
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - filter
                              - method
                              - path
                              type: object
                            type: array
                          transform_response:
                            items:
                              properties:
                                method:
                                  type: string
                                path:
                                  type: string
                                template_data:
                                  properties:
                                    enable_session:
                                      type: boolean
                                    input_type:
                                      type: string
                                    template_mode:
                                      type: string
                                    template_source:
                                      type: string
                                  required:
                                  - enable_session
                                  - input_type
                                  - template_mode
                                  - template_source
                                  type: object
                              required:
                              - method
                              - path
                              - template_data
                              type: object
                            type: array
                          transform_response_headers:
                            items:
                              properties:
                                act_on:
                                  type: boolean
                                add_headers:
                                  additionalProperties:
                                    type: string
                                  type: object
                                delete_headers:
                                  items:
                                    type: string
                                  type: array
                                method:
                                  type: string
                                path:
                                  type: string
                              required:
                              - act_on
                              - add_headers
                              - delete_headers
                              - method
                              - path
                              type: object
                            type: array
                          url_rewrites:
                            items:
                              properties:
                                match_pattern:
                                  type: string
                                method:
                                  type: string
                                path:
                                  type: string
                                rewrite_to:
                                  type: string
                                triggers:
                                  items:
                                    properties:
                                      "on":
                                        type: string
                                      options:
                                        properties:
                                          header_matches:
                                            additionalProperties:
                                              properties:
                                                match_rx:
                                                  type: string
                                                reverse:
                                                  type: boolean
                                              required:
                                              - match_rx
                                              - reverse
                                              type: object
                                            type: object
                                          path_part_matches:
                                            additionalProperties:
                                              properties:
                                                match_rx:
                                                  type: string
                                                reverse:
                                                  type: boolean
                                              required:
                                              - match_rx
                                              - reverse
                                              type: object
                                            type: object
                                          payload_matches:
                                            properties:
                                              match_rx:
                                                type: string
                                              reverse:
                                                type: boolean
                                            required:
                                            - match_rx
                                            - reverse
                                            type: object
                                          query_val_matches:
                                            additionalProperties:
                                              properties:
                                                match_rx:
                                                  type: string
                                                reverse:
                                                  type: boolean
                                              required:
                                              - match_rx
                                              - reverse
                                              type: object
                                            type: object
                                          request_context_matches:
                                            additionalProperties:
                                              properties:
                                                match_rx:
                                                  type: string
                                                reverse:
                                                  type: boolean
                                              required:
                                              - match_rx
                                              - reverse
                                              type: object
                                            type: object
                                          session_meta_matches:
                                            additionalProperties:
                                              properties:
                                                match_rx:
                                                  type: string
                                                reverse:
                                                  type: boolean
                                              required:
                                              - match_rx
                                              - reverse
                                              type: object
                                            type: object
                                        required:
                                        - header_matches
                                        - path_part_matches
                                        - payload_matches
                                        - query_val_matches
                                        - request_context_matches
                                        - session_meta_matches
                                        type: object
                                      rewrite_to:
                                        type: string
                                    required:
                                    - "on"
                                    - options
                                    - rewrite_to
                                    type: object
                                  type: array
                              required:
                              - match_pattern
                              - method
                              - path
                              - rewrite_to
                              - triggers
                              type: object
                            type: array
                          virtual:
                            items:
                              properties:
                                function_source_type:
                                  type: string
                                function_source_uri:
                                  type: string
                                method:
                                  type: string
                                path:
                                  type: string
                                proxy_on_error:
                                  type: boolean
                                response_function_name:
                                  type: string
                                use_session:
                                  type: boolean
                              required:
                              - function_source_type
                              - function_source_uri
                              - method
                              - path
                              - proxy_on_error
                              - response_function_name
                              - use_session
                              type: object
                            type: array
                          white_list:
                            items:
                              properties:
                                ignore_case:
                                  type: boolean
                                method_actions:
                                  additionalProperties:
                                    properties:
                                      action:
                                        type: string
                                      code:
                                        type: integer
                                      data:
                                        type: string
                                      headers:
                                        additionalProperties:
                                          type: string
                                        type: object
                                    required:
                                    - action
                                    - code
                                    - data
                                    - headers
                                    type: object
                                  type: object
                                path:
                                  type: string
                              required:
                              - ignore_case
                              - method_actions
                              - path
                              type: object
                            type: array
                        type: object
                      global_headers:
                        additionalProperties:
                          type: string
                        type: object
                      global_headers_remove:
                        items:
                          type: string
                        type: array
                      global_response_headers:
                        additionalProperties:
                          type: string
                        type: object
                      global_response_headers_remove:
                        items:
                          type: string
                        type: array
                      global_size_limit:
                        format: int64
                        type: integer
                      ignore_endpoint_case:
                        type: boolean
                      name:
                        type: string
                      paths:
                        properties:
                          black_list:
                            items:
                              type: string
                            type: array
                          ignored:
                            items:
                              type: string
                            type: array
                          white_list:
                            items:
                              type: string
                            type: array
                        required:
                        - black_list
                        - ignored
                        - white_list
                        type: object
                      use_extended_paths:
                        type: boolean
                    required:
                    - name
                    type: object
                  type: object
              required:
              - default_version
              - not_versioned
              type: object
          required:
          - name
          - protocol
          - proxy
          type: object
        status:
          description: ApiDefinitionStatus defines the observed state of ApiDefinition
          properties:
            api_id:
              type: string
          required:
          - api_id
          type: object
      type: object
  version: v1alpha1
  versions:
  - name: v1alpha1
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.3.0
  creationTimestamp: null
  name: securitypolicies.tyk.tyk.io
spec:
  group: tyk.tyk.io
  names:
    kind: SecurityPolicy
    listKind: SecurityPolicyList
    plural: securitypolicies
    shortNames:
    - tykpolicies
    singular: securitypolicy
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: SecurityPolicy is the Schema for the securitypolicies API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: SecurityPolicySpec defines the desired state of SecurityPolicy
          properties:
            _id:
              description: MID ("_id") is generated by Tyk once the resource is created.
                Do NOT fill this in.
              type: string
            access_rights:
              additionalProperties:
                description: from tyk/session.go AccessDefinition defines which versions
                  of an API a key has access to
                properties:
                  allowance_scope:
                    description: RestrictedTypes []graphql.Type `json:"restricted_types"`
                      Limit          APILimit     `json:"limit,omitempty"`
                    type: string
                  allowed_urls:
                    items:
                      description: AccessSpecs define what URLS a user has access
                        to an what methods are enabled
                      properties:
                        methods:
                          items:
                            type: string
                          type: array
                        url:
                          type: string
                      required:
                      - methods
                      - url
                      type: object
                    type: array
                  api_id:
                    description: 'TODO: APIID should not really be needed, as is auto-set
                      from the APIDefnition Resource'
                    type: string
                  api_name:
                    description: 'TODO: APIName should not really be needed, as is
                      auto-set from the APIDefnition Resource'
                    type: string
                  name:
                    description: Name of the ApiDefinition resource to target
                    type: string
                  namespace:
                    description: Namespace of the ApiDefinition resource to target
                    type: string
                  versions:
                    items:
                      type: string
                    type: array
                required:
                - name
                - namespace
                - versions
                type: object
              type: object
            access_rights_array:
              items:
                description: from tyk/session.go AccessDefinition defines which versions
                  of an API a key has access to
                properties:
                  allowance_scope:
                    description: RestrictedTypes []graphql.Type `json:"restricted_types"`
                      Limit          APILimit     `json:"limit,omitempty"`
                    type: string
                  allowed_urls:
                    items:
                      description: AccessSpecs define what URLS a user has access
                        to an what methods are enabled
                      properties:
                        methods:
                          items:
                            type: string
                          type: array
                        url:
                          type: string
                      required:
                      - methods
                      - url
                      type: object
                    type: array
                  api_id:
                    description: 'TODO: APIID should not really be needed, as is auto-set
                      from the APIDefnition Resource'
                    type: string
                  api_name:
                    description: 'TODO: APIName should not really be needed, as is
                      auto-set from the APIDefnition Resource'
                    type: string
                  name:
                    description: Name of the ApiDefinition resource to target
                    type: string
                  namespace:
                    description: Namespace of the ApiDefinition resource to target
                    type: string
                  versions:
                    items:
                      type: string
                    type: array
                required:
                - name
                - namespace
                - versions
                type: object
              type: array
            active:
              description: Active must be set to `true` for Tyk to load the security
                policy into memory.
              type: boolean
            enable_http_signature_validation:
              type: boolean
            hmac_enabled:
              type: boolean
            id:
              description: If you are linking an existing Policy ID to a new YAML
                CRD, then fill in this ID field with the "_id" field.  View Policies.md
                Read me for more info
              type: string
            is_inactive:
              description: IsInactive applies to the key itself. Allows enabling or
                disabling the policy without deleting it.
              type: boolean
            key_expires_in:
              description: KeyExpiresIn is the number of seconds till key expiry.
                For 1 hour is 3600. Default never expire or 0
              format: int64
              type: integer
            max_query_depth:
              description: Max depth of a GraphQL query
              type: integer
            meta_data:
              additionalProperties:
                type: string
              description: LastUpdated                   string                           `json:"last_updated"`
              type: object
            name:
              type: string
            org_id:
              description: OrgID is overwritten - no point setting this
              type: string
            partitions:
              properties:
                acl:
                  type: boolean
                complexity:
                  type: boolean
                per_api:
                  type: boolean
                quota:
                  type: boolean
                rate_limit:
                  type: boolean
              required:
              - acl
              - complexity
              - per_api
              - quota
              - rate_limit
              type: object
            per:
              description: To be used in conjunction with "Rate".  Per seconds. 1
                minute=60.  1 hour=3600 omit or "-1" for unlimited
              format: int64
              type: integer
            quota_max:
              description: Value of Quota allowed, omit or "-1" for unlimited
              format: int64
              type: integer
            quota_renewal_rate:
              description: Value reset length, in seconds, omit or "-1" for unlimited
              format: int64
              type: integer
            rate:
              description: Rate limit per X seconds (x="Per"), omit or "-1" for unlimited
              format: int64
              type: integer
            state:
              description: 'State can be active, draft or deny active: All keys are
                active and new keys can be created. draft: All keys are active but
                no new keys can be created. deny: All keys are deactivated and no
                keys can be created.'
              enum:
              - active
              - draft
              - deny
              type: string
            tags:
              description: Custom tags to apply to the key, get transfered to the
                analytics
              items:
                type: string
              type: array
            throttle_interval:
              description: If rate limited, how many seconds to retry a request for.  omit
                or "-1" for unlimited
              format: int64
              type: integer
            throttle_retry_limit:
              description: Number of retries before returning error.   omit or "-1"
                for unlimited
              type: integer
          required:
          - access_rights_array
          - active
          - name
          - state
          type: object
        status:
          description: SecurityPolicyStatus defines the observed state of SecurityPolicy
          properties:
            pol_id:
              type: string
          required:
          - pol_id
          type: object
      type: object
  version: v1alpha1
  versions:
  - name: v1alpha1
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.3.0
  creationTimestamp: null
  name: webhooks.tyk.tyk.io
spec:
  group: tyk.tyk.io
  names:
    kind: Webhook
    listKind: WebhookList
    plural: webhooks
    shortNames:
    - tykhooks
    singular: webhook
  scope: Namespaced
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      description: Webhook is the Schema for the webhooks API
      properties:
        apiVersion:
          description: 'APIVersion defines the versioned schema of this representation
            of an object. Servers should convert recognized schemas to the latest
            internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
          type: string
        kind:
          description: 'Kind is a string value representing the REST resource this
            object represents. Servers may infer this from the endpoint the client
            submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
          type: string
        metadata:
          type: object
        spec:
          description: WebhookSpec defines the desired state of Webhook
          properties:
            event_timeout:
              format: int64
              type: integer
            header_map:
              additionalProperties:
                type: string
              type: object
            id:
              description: ApiModel     `bson:"api_model,omitempty" json:"api_model,omitempty"`
                System generated resource. represents the ID to use in API  calls
              type: string
            method:
              type: string
            name:
              description: System generated resource, will be set to the {namespace/name}
                of the CRD
              type: string
            org_id:
              description: The org ID to which this webhook belongs to
              type: string
            target_path:
              type: string
            template_path:
              type: string
          required:
          - method
          - target_path
          type: object
        status:
          description: WebhookStatus defines the observed state of Webhook
          properties:
            webhook_id:
              type: string
          required:
          - webhook_id
          type: object
      type: object
  version: v1alpha1
  versions:
  - name: v1alpha1
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
---
apiVersion: admissionregistration.k8s.io/v1beta1
kind: MutatingWebhookConfiguration
metadata:
  annotations:
    cert-manager.io/inject-ca-from: tyk-operator-system/tyk-operator-serving-cert
  creationTimestamp: null
  name: tyk-operator-mutating-webhook-configuration
webhooks:
- clientConfig:
    caBundle: Cg==
    service:
      name: tyk-operator-webhook-service
      namespace: tyk-operator-system
      path: /mutate-tyk-tyk-io-v1alpha1-apidefinition
  failurePolicy: Fail
  name: mapidefinition.kb.io
  rules:
  - apiGroups:
    - tyk.tyk.io
    apiVersions:
    - v1alpha1
    operations:
    - CREATE
    - UPDATE
    resources:
    - apidefinitions
  sideEffects: None
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: tyk-operator-leader-election-role
  namespace: tyk-operator-system
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - configmaps/status
  verbs:
  - get
  - update
  - patch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  creationTimestamp: null
  name: tyk-operator-manager-role
rules:
- apiGroups:
  - tyk.tyk.io
  resources:
  - apidefinitions
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - tyk.tyk.io
  resources:
  - apidefinitions/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - tyk.tyk.io
  resources:
  - organizations
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - tyk.tyk.io
  resources:
  - organizations/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - tyk.tyk.io
  resources:
  - securitypolicies
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - tyk.tyk.io
  resources:
  - securitypolicies/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - tyk.tyk.io
  resources:
  - webhooks
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - tyk.tyk.io
  resources:
  - webhooks/status
  verbs:
  - get
  - patch
  - update
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: tyk-operator-proxy-role
rules:
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
---
apiVersion: rbac.authorization.k8s.io/v1beta1
kind: ClusterRole
metadata:
  name: tyk-operator-metrics-reader
rules:
- nonResourceURLs:
  - /metrics
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: tyk-operator-leader-election-rolebinding
  namespace: tyk-operator-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: tyk-operator-leader-election-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: tyk-operator-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: tyk-operator-manager-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tyk-operator-manager-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: tyk-operator-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: tyk-operator-proxy-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tyk-operator-proxy-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: tyk-operator-system
---
apiVersion: v1
kind: Service
metadata:
  labels:
    control-plane: controller-manager
  name: tyk-operator-controller-manager-metrics-service
  namespace: tyk-operator-system
spec:
  ports:
  - name: https
    port: 8443
    targetPort: https
  selector:
    control-plane: controller-manager
---
apiVersion: v1
kind: Service
metadata:
  name: tyk-operator-webhook-service
  namespace: tyk-operator-system
spec:
  ports:
  - port: 443
    targetPort: 9443
  selector:
    control-plane: controller-manager
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    control-plane: controller-manager
  name: tyk-operator-controller-manager
  namespace: tyk-operator-system
spec:
  replicas: 1
  selector:
    matchLabels:
      control-plane: controller-manager
  template:
    metadata:
      labels:
        control-plane: controller-manager
    spec:
      containers:
      - args:
        - --secure-listen-address=0.0.0.0:8443
        - --upstream=http://127.0.0.1:8080/
        - --logtostderr=true
        - --v=10
        image: gcr.io/kubebuilder/kube-rbac-proxy:v0.5.0
        name: kube-rbac-proxy
        ports:
        - containerPort: 8443
          name: https
      - args:
        - --metrics-addr=127.0.0.1:8080
        - --enable-leader-election
        command:
        - /manager
        envFrom:
        - secretRef:
            name: tyk-operator-conf
        image: {{ .Values.repository }}:{{ .Values.tag }}
        imagePullPolicy: Always
        name: manager
        ports:
        - containerPort: 9443
          name: webhook-server
          protocol: TCP
        resources:
          limits:
            cpu: 100m
            memory: 30Mi
          requests:
            cpu: 100m
            memory: 20Mi
        volumeMounts:
        - mountPath: /tmp/k8s-webhook-server/serving-certs
          name: cert
          readOnly: true
      terminationGracePeriodSeconds: 10
      volumes:
      - name: cert
        secret:
          defaultMode: 420
          secretName: webhook-server-cert
---
apiVersion: cert-manager.io/v1alpha2
kind: Certificate
metadata:
  name: tyk-operator-serving-cert
  namespace: tyk-operator-system
spec:
  dnsNames:
  - tyk-operator-webhook-service.tyk-operator-system.svc
  - tyk-operator-webhook-service.tyk-operator-system.svc.cluster.local
  issuerRef:
    kind: Issuer
    name: tyk-operator-selfsigned-issuer
  secretName: webhook-server-cert
---
apiVersion: cert-manager.io/v1alpha2
kind: Issuer
metadata:
  name: tyk-operator-selfsigned-issuer
  namespace: tyk-operator-system
spec:
  selfSigned: {}
---
apiVersion: admissionregistration.k8s.io/v1beta1
kind: ValidatingWebhookConfiguration
metadata:
  annotations:
    cert-manager.io/inject-ca-from: tyk-operator-system/tyk-operator-serving-cert
  creationTimestamp: null
  name: tyk-operator-validating-webhook-configuration
webhooks:
- clientConfig:
    caBundle: Cg==
    service:
      name: tyk-operator-webhook-service
      namespace: tyk-operator-system
      path: /validate-tyk-tyk-io-v1alpha1-apidefinition
  failurePolicy: Fail
  name: vapidefinition.kb.io
  rules:
  - apiGroups:
    - tyk.tyk.io
    apiVersions:
    - v1alpha1
    operations:
    - CREATE
    - UPDATE
    resources:
    - apidefinitions
  sideEffects: None
