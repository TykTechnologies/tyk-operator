apiVersion: tyk.tyk.io/v1
kind: SecurityPolicy
metadata:
  name: httpbin
spec:
  # TODO: COULD WE / SHOULD WE USE ${METADATA.NAME}.${METADATA.NAMESPACE}?
  name: MyPolicy
  # TODO: DO WE HAVE TO SET THIS? IS IT ONLY APPLICABLE FOR TYK_PRO
  org_id: acme.com
  active: true
  is_inactive: false
  state: active
  access_rights_array:
# TODO: HOW TO SENSIBLY TARGET ACCESS_RIGHTS_ARRAY for AN API DEFINITION?
# WHAT IF K8s is being used to manage APIs outside of K8s?

# PROPOSAL 1:
# api_id: ${METADATA.NAME}.${METADATA.NAMESPACE}
# api_name: we can pull this from the customresource

# PROPOSAL 2: Use label selectors

# PROPOSAL 3: Remove api_id & api_name from types. Then provide `namespace` & `name` instead?

    - api_name: httpbin
      api_id: httpbin.default
      versions:
        - Default
#      allowance_scope: []
#      allowed_urls: []
#      limit: {}
#  enable_http_signature_validation:
#  hmac_enabled:

# TODO: WHAT IS THIS? Can it be inferred based on label selectors?
#  auth_type: authToken
#  auth_types:
#    - authToken

# TODO: Think about defaulting so we don't have to set these values to -1
  per: -1
  quota_max: -1
  quota_renewal_rate: -1
  rate: -1
  throttle_interval: -1
  throttle_retry_limit: -1
  max_query_depth: -1

  key_expires_in: 0
  tags: []

# TODO: can we set sensible defaults for partitions?
  partitions:
    quota: true
    rate_limit: true
    acl: true
    complexity: false
    per_api: false
