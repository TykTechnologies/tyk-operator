
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.4.1
  creationTimestamp: null
  name: securitypolicies.tyk.tyk.io
spec:
  group: tyk.tyk.io
  names:
    kind: SecurityPolicy
    listKind: SecurityPolicyList
    plural: securitypolicies
    shortNames:
    - tykpolicies
    singular: securitypolicy
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: SecurityPolicy is the Schema for the securitypolicies API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: SecurityPolicySpec defines the desired state of SecurityPolicy
            properties:
              _id:
                description: MID ("_id") is generated by Tyk once the resource is
                  created. Do NOT fill this in.
                type: string
              access_rights:
                additionalProperties:
                  description: AccessDefinition defines which versions of an API a
                    key has access to
                  properties:
                    allowance_scope:
                      type: string
                    allowed_types:
                      description: Field access of GraphQL APIs can be restricted
                        by setting up an allowed types list in a policy or directly
                        on a key.
                      items:
                        description: GraphQLType represents a GraphQL Type for Tyk.
                        properties:
                          fields:
                            items:
                              type: string
                            type: array
                          name:
                            type: string
                        required:
                        - fields
                        - name
                        type: object
                      type: array
                    allowed_urls:
                      items:
                        description: AccessSpec defines what URLS a user has access
                          to and what methods are enabled
                        properties:
                          methods:
                            items:
                              type: string
                            type: array
                          url:
                            type: string
                        required:
                        - methods
                        - url
                        type: object
                      type: array
                    api_id:
                      description: 'TODO: APIID should not really be needed, as is
                        auto-set from the APIDefnition Resource'
                      type: string
                    api_name:
                      description: 'TODO: APIName should not really be needed, as
                        is auto-set from the APIDefnition Resource'
                      type: string
                    disable_introspection:
                      description: DisableIntrospection disables GraphQL introspection
                        if it is set to True.
                      type: boolean
                    field_access_rights:
                      description: FieldAccessRights is array of depth limit settings
                        per GraphQL APIs.
                      items:
                        description: FieldAccessDefinition represent a struct for
                          depth limit settings per API.
                        properties:
                          field_name:
                            description: FieldName represents the name of the Query
                              or Mutation which the limit applies to.
                            type: string
                          limits:
                            description: Limit specifies the numerical value of the
                              limit.
                            properties:
                              max_query_depth:
                                description: MaxQueryDepth represents the numerical
                                  value of the limit.
                                format: int64
                                type: integer
                            required:
                            - max_query_depth
                            type: object
                          type_name:
                            description: TypeName points to a type on which depth
                              limit is set. It can be either Query (most common case)
                              or Mutation
                            type: string
                        type: object
                      type: array
                    name:
                      description: Name of the ApiDefinition resource to target
                      type: string
                    namespace:
                      description: Namespace of the ApiDefinition resource to target
                      type: string
                    restricted_types:
                      description: Field access of GraphQL APIs can be restricted
                        by setting up an allowed types list in a policy or directly
                        on a key.
                      items:
                        description: GraphQLType represents a GraphQL Type for Tyk.
                        properties:
                          fields:
                            items:
                              type: string
                            type: array
                          name:
                            type: string
                        required:
                        - fields
                        - name
                        type: object
                      type: array
                    versions:
                      items:
                        type: string
                      type: array
                  required:
                  - name
                  - namespace
                  type: object
                type: object
              access_rights_array:
                items:
                  description: AccessDefinition defines which versions of an API a
                    key has access to
                  properties:
                    allowance_scope:
                      type: string
                    allowed_types:
                      description: Field access of GraphQL APIs can be restricted
                        by setting up an allowed types list in a policy or directly
                        on a key.
                      items:
                        description: GraphQLType represents a GraphQL Type for Tyk.
                        properties:
                          fields:
                            items:
                              type: string
                            type: array
                          name:
                            type: string
                        required:
                        - fields
                        - name
                        type: object
                      type: array
                    allowed_urls:
                      items:
                        description: AccessSpec defines what URLS a user has access
                          to and what methods are enabled
                        properties:
                          methods:
                            items:
                              type: string
                            type: array
                          url:
                            type: string
                        required:
                        - methods
                        - url
                        type: object
                      type: array
                    api_id:
                      description: 'TODO: APIID should not really be needed, as is
                        auto-set from the APIDefnition Resource'
                      type: string
                    api_name:
                      description: 'TODO: APIName should not really be needed, as
                        is auto-set from the APIDefnition Resource'
                      type: string
                    disable_introspection:
                      description: DisableIntrospection disables GraphQL introspection
                        if it is set to True.
                      type: boolean
                    field_access_rights:
                      description: FieldAccessRights is array of depth limit settings
                        per GraphQL APIs.
                      items:
                        description: FieldAccessDefinition represent a struct for
                          depth limit settings per API.
                        properties:
                          field_name:
                            description: FieldName represents the name of the Query
                              or Mutation which the limit applies to.
                            type: string
                          limits:
                            description: Limit specifies the numerical value of the
                              limit.
                            properties:
                              max_query_depth:
                                description: MaxQueryDepth represents the numerical
                                  value of the limit.
                                format: int64
                                type: integer
                            required:
                            - max_query_depth
                            type: object
                          type_name:
                            description: TypeName points to a type on which depth
                              limit is set. It can be either Query (most common case)
                              or Mutation
                            type: string
                        type: object
                      type: array
                    name:
                      description: Name of the ApiDefinition resource to target
                      type: string
                    namespace:
                      description: Namespace of the ApiDefinition resource to target
                      type: string
                    restricted_types:
                      description: Field access of GraphQL APIs can be restricted
                        by setting up an allowed types list in a policy or directly
                        on a key.
                      items:
                        description: GraphQLType represents a GraphQL Type for Tyk.
                        properties:
                          fields:
                            items:
                              type: string
                            type: array
                          name:
                            type: string
                        required:
                        - fields
                        - name
                        type: object
                      type: array
                    versions:
                      items:
                        type: string
                      type: array
                  required:
                  - name
                  - namespace
                  type: object
                type: array
              active:
                description: Active must be set to `true` for Tyk to load the security
                  policy into memory.
                type: boolean
              contextRef:
                description: Context specify namespace/name of the OperatorContext
                  object used for reconciling this SecurityPolicy CR.
                properties:
                  name:
                    description: k8s resource name
                    type: string
                  namespace:
                    description: The k8s namespace of the resource being targetted.
                      When omitted this will be set to the namespace of the object
                      that is being reconciled.
                    type: string
                required:
                - name
                type: object
              enable_http_signature_validation:
                type: boolean
              hmac_enabled:
                type: boolean
              id:
                description: If you are linking an existing Policy ID to a new YAML
                  CRD, then fill in this ID field with the "_id" field. See policies.md
                  readme for more info
                type: string
              is_inactive:
                description: IsInactive applies to the key itself. Allows enabling
                  or disabling the policy without deleting it.
                type: boolean
              key_expires_in:
                description: KeyExpiresIn is the number of seconds till key expiry.
                  For 1 hour is 3600. Default never expire or 0
                format: int64
                type: integer
              max_query_depth:
                description: Max depth of a GraphQL query
                type: integer
              meta_data:
                additionalProperties:
                  type: string
                description: LastUpdated                   string                           `json:"last_updated"`
                type: object
              name:
                description: Name represents the name of the security policy as displayed
                  in the Dashboard
                type: string
              org_id:
                description: OrgID is overwritten - no point setting this
                type: string
              partitions:
                properties:
                  acl:
                    type: boolean
                  complexity:
                    type: boolean
                  per_api:
                    type: boolean
                  quota:
                    type: boolean
                  rate_limit:
                    type: boolean
                type: object
              per:
                description: To be used in conjunction with "Rate".  Per seconds.
                  1 minute=60.  1 hour=3600 omit or "-1" for unlimited
                format: int64
                type: integer
              quota_max:
                description: Value of Quota allowed, omit or "-1" for unlimited
                format: int64
                type: integer
              quota_renewal_rate:
                description: Value reset length, in seconds, omit or "-1" for unlimited
                format: int64
                type: integer
              rate:
                description: Rate limit per X seconds (x="Per"), omit or "-1" for
                  unlimited
                format: int64
                type: integer
              state:
                description: 'State can be active, draft or deny active: All keys
                  are active and new keys can be created. draft: All keys are active
                  but no new keys can be created. deny: All keys are deactivated and
                  no keys can be created.'
                enum:
                - active
                - draft
                - deny
                type: string
              tags:
                description: Custom tags to apply to the key, get transfered to the
                  analytics
                items:
                  type: string
                type: array
              throttle_interval:
                description: If rate limited, how many seconds to retry a request
                  for.  omit or "-1" for unlimited
                format: int64
                type: integer
              throttle_retry_limit:
                description: Number of retries before returning error.   omit or "-1"
                  for unlimited
                type: integer
            required:
            - active
            - name
            - state
            type: object
          status:
            description: SecurityPolicyStatus defines the observed state of SecurityPolicy
            properties:
              latestK8sHash:
                description: LatestCRDHash corresponds to hash of lastly created or
                  updated SecurityPolicy CR.
                type: string
              latestTykHash:
                description: LatestTykHash corresponds to hash of lastly created or
                  updated SecurityPolicy on Tyk.
                type: string
              linked_apis:
                items:
                  properties:
                    name:
                      description: k8s resource name
                      type: string
                    namespace:
                      description: The k8s namespace of the resource being targetted.
                        When omitted this will be set to the namespace of the object
                        that is being reconciled.
                      type: string
                  required:
                  - name
                  type: object
                type: array
              pol_id:
                type: string
            required:
            - pol_id
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []
